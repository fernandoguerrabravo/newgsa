{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Documents/gsa_16/newgsa/src/views/SkuList/components/SkuStoreFiles.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { checkFileMIMEType, checkFileSize, getFormattedSize } from \"../helpers/files.helper\";\nimport AttachmentIcon from '@mui/icons-material/Attachment';\nimport InfoIcon from '@mui/icons-material/Info';\nimport PublishIcon from '@mui/icons-material/Info';\nimport Swal from \"sweetalert2\";\nimport { useTheme } from \"@mui/material/styles\";\nimport { FormLabel, TextField, FormControlLabel, FormControl, InputLabel, Select, MenuItem, Button, Card, CardActions, CardContent, CardHeader, CardMedia, Divider, Grid, Typography, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Tooltip } from \"@mui/material\";\nimport FileProvider from '../providers/file.provider';\nimport { red, blue } from \"@mui/material/colors\";\nimport SubCard from \"ui-component/cards/SubCard\";\nimport DataTable from \"react-data-table-component\";\nimport IconButton from \"@mui/material/IconButton\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst blobToBase64 = async file => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.readAsDataURL(file);\n\n  reader.onload = () => resolve(reader.result);\n\n  reader.onerror = error => reject(error);\n});\n/*\nconst useStyles = makeStyles({\n  table: {\n    minWidth: 650,\n  },\n});\n\nconst styles2 = makeStyles((theme) => ({\n  icons: {\n    fontSize: \"small\",\n    backgroundColor: red[500],\n    color: red[500],\n  },\n\n  formControl2: {\n    minWidth: 300,\n    padding: theme.spacing(1),\n  },\n\n  input: {\n    display: \"none\",\n  },\n\n  formControl1: {\n    minWidth: 100,\n    padding: theme.spacing(1),\n  },\n}));\n*/\n\n\nconst SkuStoreFiles = ({\n  skus,\n  idcliente\n}) => {\n  _s();\n\n  const theme = useTheme();\n  const cardStyle = {\n    background: theme.palette.mode === \"dark\" ? theme.palette.dark.main : theme.palette.grey[50],\n    border: \"1px solid\",\n    borderColor: theme.palette.mode === \"dark\" ? theme.palette.dark.main : theme.palette.grey[100]\n  };\n  const MAXIMUM_FILES_LIMIT = 5;\n  /**\n   * Size in MB\n   */\n\n  const MAXIMUM_FILE_SIZE = 2;\n  const ALLOWED_FORMATS = \".pdf, .doc, .docx, .odt, image/*\";\n  const [files, setFiles] = useState([]); // const [refId, setRefId] = useState(idcliente);\n  // const [skur, setSku] = useState('');\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const getCurrentFiles = async event => {\n    const rawFiles = event.target.files;\n    const fileList = []; // WIll contain an array of type File[]\n\n    if (!rawFiles) {\n      return;\n    }\n\n    if (rawFiles instanceof Array) {\n      rawFiles.forEach(file => fileList.push(file));\n    } else {\n      const rawFilesArray = Array.from(rawFiles);\n      rawFilesArray.forEach(file => fileList.push(file));\n    }\n\n    const finalFileList = [];\n\n    for (const file of fileList) {\n      var _encodedData$toString;\n\n      const extensionSeparatorIndex = file.name.lastIndexOf(\".\");\n      const formattedName = file.name.substring(0, extensionSeparatorIndex);\n      const extension = file.name.substr(extensionSeparatorIndex);\n      const encodedData = await blobToBase64(file);\n      const formattedFile = {\n        name: formattedName,\n        extension,\n        file: (_encodedData$toString = encodedData === null || encodedData === void 0 ? void 0 : encodedData.toString()) !== null && _encodedData$toString !== void 0 ? _encodedData$toString : \"\",\n        type: \"append\",\n        size: file.size\n      };\n\n      if (files.find(appendedFile => appendedFile.name === formattedFile.name)) {\n        Swal.fire({\n          icon: \"info\",\n          title: `The file ${formattedFile.name + formattedFile.extension} is already added`\n        });\n        break;\n      }\n\n      if (!checkFileMIMEType(file.type, ALLOWED_FORMATS)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: \"Please select another file (Supported formats: images and PDF)\",\n          html: `<small class=\"text-muted\">The file ${file.name} is not supported</small>`\n        });\n        break;\n      }\n\n      if (!checkFileSize(file.size, MAXIMUM_FILE_SIZE)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: `The maximum file size is ${MAXIMUM_FILE_SIZE}MB`,\n          html: `<small class=\"text-muted\">The file ${file.name} have a size of ${getFormattedSize(file.size, 2)}</small>`\n        });\n        break;\n      }\n\n      if (files.length < MAXIMUM_FILES_LIMIT) {\n        finalFileList.push(formattedFile);\n      } else {\n        Swal.fire({\n          icon: \"info\",\n          title: `The maximum file quantity to upload is ${MAXIMUM_FILES_LIMIT}`\n        });\n        break;\n      }\n    }\n\n    if (finalFileList.length > 0) {\n      setFiles([...files, ...finalFileList]);\n    }\n\n    event.target.value = event.target.defaultValue; // Reset input cached value\n  };\n  /* const handleRefIdChange = (event) => {\n   if (event.isTrusted) {\n  \t setRefId(event.target.value)\n   }\n  } \n  \t const handleSkuChange = (event) => {\n   if (event.isTrusted) {\n  \t setSku(event.target.value);\n   }\n  }v */\n\n\n  const handleFilesSubmit = async event => {\n    event.preventDefault();\n\n    if (event.isTrusted && skus !== \"\") {\n      const proceed = await Swal.fire({\n        title: \"The files will be uploaded. Proceed?\",\n        icon: \"question\",\n        confirmButtonText: \"Yes\",\n        cancelButtonText: \"No. Abort action\",\n        showCancelButton: true\n      });\n\n      if (!(proceed === null || proceed === void 0 ? void 0 : proceed.isConfirmed)) {\n        return;\n      }\n\n      setSubmitting(true);\n\n      try {\n        var _response$value;\n\n        const response = (await new FileProvider().submitFiles(files, idcliente, skus)).data;\n\n        if (response === null || response === void 0 ? void 0 : (_response$value = response.value) === null || _response$value === void 0 ? void 0 : _response$value.fileUpload) {\n          await Swal.fire({\n            title: `${files.length > 1 ? \"Files\" : \"File\"} uploaded successfully`,\n            icon: \"success\"\n          });\n          setFiles([]);\n        } else {\n          var _response$error$messa;\n\n          await Swal.fire({\n            title: (_response$error$messa = response.error.message) !== null && _response$error$messa !== void 0 ? _response$error$messa : \"Unexpected error\",\n            icon: \"error\"\n          });\n        }\n      } catch (reason) {\n        Swal.fire({\n          title: \"Unexpected error\",\n          text: \"Please try again later\",\n          icon: \"error\"\n        });\n      }\n\n      setSubmitting(false);\n      event.target.reset();\n    } else {\n      Swal.fire({\n        title: \"Opps!!\",\n        text: \"Please enter a valid SKU\",\n        icon: \"Warning\"\n      });\n    }\n  };\n\n  const removeFile = (event, index) => {\n    if (event.isTrusted) {\n      const currentFiles = files;\n      currentFiles.splice(index, 1);\n      setFiles([...currentFiles]);\n    }\n  };\n\n  useEffect(() => {\n    document.title = \"S3 REST API w/ File Upload Example\";\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleFilesSubmit,\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      gutterBottom: true,\n      children: [\"Upload Documents and Images\", /*#__PURE__*/_jsxDEV(Tooltip, {\n        title: \"you can later upload documents or images of your product.\",\n        children: /*#__PURE__*/_jsxDEV(InfoIcon, {\n          fontSize: \"small\",\n          color: \"action\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        id: \"file1\",\n        name: \"file1\",\n        type: \"file\",\n        onChange: getCurrentFiles,\n        variant: \"outlined\",\n        multiple: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"file1\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          startIcon: /*#__PURE__*/_jsxDEV(AttachmentIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 24\n          }, this),\n          size: \"large\",\n          variant: \"outlined\",\n          component: \"span\",\n          children: \"Select File ...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this), files.length > 0 ? /*#__PURE__*/_jsxDEV(FormControl, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        startIcon: /*#__PURE__*/_jsxDEV(PublishIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 24\n        }, this),\n        size: \"large\",\n        variant: \"outlined\",\n        color: \"primary\",\n        type: \"submit\",\n        children: \"Upload List\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(Typography, {\n      gutterBottom: true,\n      children: files.length > 0 ? `Files in queue (${files.length}):` : \"No files in queue yet\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this), files.length > 0 ? /*#__PURE__*/_jsxDEV(TableContainer, {\n      children: /*#__PURE__*/_jsxDEV(Table, {\n        \"aria-label\": \"simple table\",\n        children: [/*#__PURE__*/_jsxDEV(TableHead, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"File Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"File Extension\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"File Size\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n          children: files.map((file, index) => {\n            return /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: file.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: file.extension\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: getFormattedSize(file.size, 2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"outlined\",\n                  type: \"button\",\n                  onClick: event => removeFile(event, index),\n                  disabled: submitting,\n                  children: \"Remove\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 21\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 262,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SkuStoreFiles, \"45xJdnIZX9XD4Q/85YcJUHpP5ZY=\", false, function () {\n  return [useTheme];\n});\n\n_c = SkuStoreFiles;\nexport default SkuStoreFiles;\n\nvar _c;\n\n$RefreshReg$(_c, \"SkuStoreFiles\");","map":{"version":3,"sources":["/Users/admin/Documents/gsa_16/newgsa/src/views/SkuList/components/SkuStoreFiles.jsx"],"names":["React","useState","useEffect","useMemo","checkFileMIMEType","checkFileSize","getFormattedSize","AttachmentIcon","InfoIcon","PublishIcon","Swal","useTheme","FormLabel","TextField","FormControlLabel","FormControl","InputLabel","Select","MenuItem","Button","Card","CardActions","CardContent","CardHeader","CardMedia","Divider","Grid","Typography","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Tooltip","FileProvider","red","blue","SubCard","DataTable","IconButton","blobToBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","SkuStoreFiles","skus","idcliente","theme","cardStyle","background","palette","mode","dark","main","grey","border","borderColor","MAXIMUM_FILES_LIMIT","MAXIMUM_FILE_SIZE","ALLOWED_FORMATS","files","setFiles","submitting","setSubmitting","getCurrentFiles","event","rawFiles","target","fileList","Array","forEach","push","rawFilesArray","from","finalFileList","extensionSeparatorIndex","name","lastIndexOf","formattedName","substring","extension","substr","encodedData","formattedFile","toString","type","size","find","appendedFile","fire","icon","title","html","length","value","defaultValue","handleFilesSubmit","preventDefault","isTrusted","proceed","confirmButtonText","cancelButtonText","showCancelButton","isConfirmed","response","submitFiles","data","fileUpload","message","reason","text","reset","removeFile","index","currentFiles","splice","document","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\nimport {\n  checkFileMIMEType,\n  checkFileSize,\n  getFormattedSize,\n} from \"../helpers/files.helper\";\nimport AttachmentIcon from '@mui/icons-material/Attachment';\nimport InfoIcon  from '@mui/icons-material/Info';\nimport PublishIcon  from '@mui/icons-material/Info';\n\nimport Swal from \"sweetalert2\";\n\nimport { useTheme } from \"@mui/material/styles\";\nimport {\n  FormLabel,\n  TextField,\n  FormControlLabel,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  Button,\n  Card,\n  CardActions,\n  CardContent,\n  CardHeader,\n  CardMedia,\n  Divider,\n  Grid,\n  Typography,\n  Paper,\n Table,\n TableBody ,\n TableCell ,\n TableContainer ,\n TableHead ,\n TableRow ,\n \n Tooltip ,\n \n\n} from \"@mui/material\";\nimport FileProvider from '../providers/file.provider';\n\nimport { red, blue } from \"@mui/material/colors\";\nimport SubCard from \"ui-component/cards/SubCard\";\nimport DataTable from \"react-data-table-component\";\nimport IconButton from \"@mui/material/IconButton\";\n\nconst blobToBase64 = async (file) =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = (error) => reject(error);\n  });\n\n/*\nconst useStyles = makeStyles({\n  table: {\n    minWidth: 650,\n  },\n});\n\nconst styles2 = makeStyles((theme) => ({\n  icons: {\n    fontSize: \"small\",\n    backgroundColor: red[500],\n    color: red[500],\n  },\n\n  formControl2: {\n    minWidth: 300,\n    padding: theme.spacing(1),\n  },\n\n  input: {\n    display: \"none\",\n  },\n\n  formControl1: {\n    minWidth: 100,\n    padding: theme.spacing(1),\n  },\n}));\n*/\n\nconst SkuStoreFiles = ({ skus, idcliente }) => {\n  \n\tconst theme = useTheme();\n  const cardStyle = {\n    background:\n      theme.palette.mode === \"dark\"\n        ? theme.palette.dark.main\n        : theme.palette.grey[50],\n    border: \"1px solid\",\n    borderColor:\n      theme.palette.mode === \"dark\"\n        ? theme.palette.dark.main\n        : theme.palette.grey[100],\n  };\n\n  const MAXIMUM_FILES_LIMIT = 5;\n  /**\n   * Size in MB\n   */\n  const MAXIMUM_FILE_SIZE = 2;\n  const ALLOWED_FORMATS = \".pdf, .doc, .docx, .odt, image/*\";\n\n  const [files, setFiles] = useState([]);\n  // const [refId, setRefId] = useState(idcliente);\n  // const [skur, setSku] = useState('');\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const getCurrentFiles = async (event) => {\n    const rawFiles = event.target.files;\n    const fileList = []; // WIll contain an array of type File[]\n    if (!rawFiles) {\n      return;\n    }\n    if (rawFiles instanceof Array) {\n      rawFiles.forEach((file) => fileList.push(file));\n    } else {\n      const rawFilesArray = Array.from(rawFiles);\n      rawFilesArray.forEach((file) => fileList.push(file));\n    }\n    const finalFileList = [];\n    for (const file of fileList) {\n      const extensionSeparatorIndex = file.name.lastIndexOf(\".\");\n      const formattedName = file.name.substring(0, extensionSeparatorIndex);\n      const extension = file.name.substr(extensionSeparatorIndex);\n      const encodedData = await blobToBase64(file);\n      const formattedFile = {\n        name: formattedName,\n        extension,\n        file: encodedData?.toString() ?? \"\",\n        type: \"append\",\n        size: file.size,\n      };\n      if (\n        files.find((appendedFile) => appendedFile.name === formattedFile.name)\n      ) {\n        Swal.fire({\n          icon: \"info\",\n          title: `The file ${\n            formattedFile.name + formattedFile.extension\n          } is already added`,\n        });\n        break;\n      }\n      if (!checkFileMIMEType(file.type, ALLOWED_FORMATS)) {\n        Swal.fire({\n          icon: \"warning\",\n          title:\n            \"Please select another file (Supported formats: images and PDF)\",\n          html: `<small class=\"text-muted\">The file ${file.name} is not supported</small>`,\n        });\n        break;\n      }\n      if (!checkFileSize(file.size, MAXIMUM_FILE_SIZE)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: `The maximum file size is ${MAXIMUM_FILE_SIZE}MB`,\n          html: `<small class=\"text-muted\">The file ${\n            file.name\n          } have a size of ${getFormattedSize(file.size, 2)}</small>`,\n        });\n        break;\n      }\n      if (files.length < MAXIMUM_FILES_LIMIT) {\n        finalFileList.push(formattedFile);\n      } else {\n        Swal.fire({\n          icon: \"info\",\n          title: `The maximum file quantity to upload is ${MAXIMUM_FILES_LIMIT}`,\n        });\n        break;\n      }\n    }\n    if (finalFileList.length > 0) {\n      setFiles([...files, ...finalFileList]);\n    }\n    event.target.value = event.target.defaultValue; // Reset input cached value\n  };\n\n  /* const handleRefIdChange = (event) => {\n\t\t if (event.isTrusted) {\n\t\t\t setRefId(event.target.value)\n\t\t }\n\t } \n \n\t const handleSkuChange = (event) => {\n\t\t if (event.isTrusted) {\n\t\t\t setSku(event.target.value);\n\t\t }\n\t }v */\n\n  const handleFilesSubmit = async (event) => {\n    event.preventDefault();\n    if (event.isTrusted && skus !== \"\") {\n      const proceed = await Swal.fire({\n        title: \"The files will be uploaded. Proceed?\",\n        icon: \"question\",\n        confirmButtonText: \"Yes\",\n        cancelButtonText: \"No. Abort action\",\n        showCancelButton: true,\n      });\n      if (!proceed?.isConfirmed) {\n        return;\n      }\n      setSubmitting(true);\n      try {\n        const response = (\n          await new FileProvider().submitFiles(files, idcliente, skus)\n        ).data;\n        if (response?.value?.fileUpload) {\n          await Swal.fire({\n            title: `${\n              files.length > 1 ? \"Files\" : \"File\"\n            } uploaded successfully`,\n            icon: \"success\",\n          });\n          setFiles([]);\n        } else {\n          await Swal.fire({\n            title: response.error.message ?? \"Unexpected error\",\n            icon: \"error\",\n          });\n        }\n      } catch (reason) {\n        Swal.fire({\n          title: \"Unexpected error\",\n          text: \"Please try again later\",\n          icon: \"error\",\n        });\n      }\n      setSubmitting(false);\n      event.target.reset();\n    } else {\n      Swal.fire({\n        title: \"Opps!!\",\n        text: \"Please enter a valid SKU\",\n        icon: \"Warning\",\n      });\n    }\n  };\n\n  const removeFile = (event, index) => {\n    if (event.isTrusted) {\n      const currentFiles = files;\n      currentFiles.splice(index, 1);\n      setFiles([...currentFiles]);\n    }\n  };\n\n  useEffect(() => {\n    document.title = \"S3 REST API w/ File Upload Example\";\n  }, []);\n\n  return (\n    <form onSubmit={handleFilesSubmit}>\n      <Typography variant=\"h6\" gutterBottom>\n        Upload Documents and Images\n        <Tooltip title=\"you can later upload documents or images of your product.\">\n          <InfoIcon fontSize=\"small\" color=\"action\" />\n        </Tooltip>\n      </Typography>\n      <FormControl>\n        <TextField\n          id=\"file1\"\n          name=\"file1\"\n          type=\"file\"\n          onChange={getCurrentFiles}\n          variant=\"outlined\"\n          multiple\n        />\n        <label htmlFor=\"file1\">\n          <Button\n            startIcon={<AttachmentIcon />}\n            size=\"large\"\n            variant=\"outlined\"\n            component=\"span\"\n          >\n            Select File ...\n          </Button>\n        </label>\n      </FormControl>\n\n      {files.length > 0 ? (\n        <FormControl>\n          <Button\n            startIcon={<PublishIcon />}\n            size=\"large\"\n            variant=\"outlined\"\n            color=\"primary\"\n            type=\"submit\"\n          >\n            Upload List\n          </Button>\n        </FormControl>\n      ) : null}\n\n      <Typography  gutterBottom>\n        {files.length > 0\n          ? `Files in queue (${files.length}):`\n          : \"No files in queue yet\"}\n      </Typography>\n      {files.length > 0 ? (\n        <TableContainer >\n          <Table  aria-label=\"simple table\">\n            <TableHead>\n              <TableRow>\n                <TableCell>File Name</TableCell>\n                <TableCell>File Extension</TableCell>\n                <TableCell>File Size</TableCell>\n                <TableCell>Actions</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {files.map((file, index) => {\n                return (\n                  <TableRow key={index}>\n                    <TableCell>{file.name}</TableCell>\n                    <TableCell>{file.extension}</TableCell>\n                    <TableCell>{getFormattedSize(file.size, 2)}</TableCell>\n                    <TableCell>\n                      <Button\n                        variant=\"outlined\"\n                        type=\"button\"\n                        onClick={(event) => removeFile(event, index)}\n                        disabled={submitting}\n                      >\n                        Remove\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                );\n              })}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      ) : null}\n    </form>\n  );\n};\n\nexport default SkuStoreFiles;\n"]},"metadata":{},"sourceType":"module"}