{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Documents/gsatotal/newgsa/src/views/profile/components/SellerStoreFiles.jsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable no-unused-vars */\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@mui/material/styles\";\nimport { Paper, Button, Grid, Divider, FormLabel, FormControlLabel } from \"@mui/material\";\nimport TextField from \"@mui/material/TextField\";\nimport Swal from \"sweetalert2\";\nimport Table from \"@mui/material/Table\";\nimport TableBody from \"@mui/material/TableBody\";\nimport TableCell from \"@mui/material/TableCell\";\nimport TableContainer from \"@mui/material/TableContainer\";\nimport TableHead from \"@mui/material/TableHead\";\nimport TableRow from \"@mui/material/TableRow\";\nimport Typography from \"@mui/material/Typography\";\nimport { green, red, blue } from \"@mui/material/colors\";\nimport Tooltip from \"@mui/material/Tooltip\";\nimport FormControl from \"@mui/material/FormControl\";\nimport { Save, Attachment, Info, Publish } from \"@mui/icons-material\";\nimport FileProvider from \"../providers/file.provider\";\nimport { checkFileMIMEType, checkFileSize, getFormattedSize } from \"../helpers/files.helper\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst blobToBase64 = async file => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.readAsDataURL(file);\n\n  reader.onload = () => resolve(reader.result);\n\n  reader.onerror = error => reject(error);\n});\n/* const useStyles = makeStyles({\n  table: {\n    minWidth: 650,\n  },\n}); */\n\n/* const styles2 = makeStyles((theme) => ({\n  icons: {\n    fontSize: \"small\",\n    backgroundColor: red[500],\n    color: red[500],\n  },\n\n  formControl2: {\n    minWidth: 300,\n    padding: theme.spacing(1),\n  },\n\n  input: {\n    display: \"none\",\n  },\n\n  formControl1: {\n    minWidth: 100,\n    padding: theme.spacing(1),\n  },\n})); */\n\n\nconst SellerStoreFiles = ({\n  skus,\n  idcliente\n}) => {\n  _s();\n\n  const MAXIMUM_FILES_LIMIT = 5;\n  /**\n   * Size in MB\n   */\n\n  const MAXIMUM_FILE_SIZE = 2;\n  const ALLOWED_FORMATS = \".pdf, .doc, .docx, .odt, image/*\";\n  const [files, setFiles] = useState([]); // const [refId, setRefId] = useState(idcliente);\n  // const [skur, setSku] = useState('');\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const getCurrentFiles = async event => {\n    const rawFiles = event.target.files;\n    const fileList = []; // WIll contain an array of type File[]\n\n    if (!rawFiles) {\n      return;\n    }\n\n    if (rawFiles instanceof Array) {\n      rawFiles.forEach(file => fileList.push(file));\n    } else {\n      const rawFilesArray = Array.from(rawFiles);\n      rawFilesArray.forEach(file => fileList.push(file));\n    }\n\n    const finalFileList = [];\n\n    for (const file of fileList) {\n      var _encodedData$toString;\n\n      const extensionSeparatorIndex = file.name.lastIndexOf(\".\");\n      const formattedName = file.name.substring(0, extensionSeparatorIndex);\n      const extension = file.name.substr(extensionSeparatorIndex);\n      const encodedData = await blobToBase64(file);\n      const formattedFile = {\n        name: formattedName,\n        extension,\n        file: (_encodedData$toString = encodedData === null || encodedData === void 0 ? void 0 : encodedData.toString()) !== null && _encodedData$toString !== void 0 ? _encodedData$toString : \"\",\n        type: \"append\",\n        size: file.size\n      };\n\n      if (files.find(appendedFile => appendedFile.name === formattedFile.name)) {\n        Swal.fire({\n          icon: \"info\",\n          title: `The file ${formattedFile.name + formattedFile.extension} is already added`\n        });\n        break;\n      }\n\n      if (!checkFileMIMEType(file.type, ALLOWED_FORMATS)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: \"Please select another file (Supported formats: images and PDF)\",\n          html: `<small class=\"text-muted\">The file ${file.name} is not supported</small>`\n        });\n        break;\n      }\n\n      if (!checkFileSize(file.size, MAXIMUM_FILE_SIZE)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: `The maximum file size is ${MAXIMUM_FILE_SIZE}MB`,\n          html: `<small class=\"text-muted\">The file ${file.name} have a size of ${getFormattedSize(file.size, 2)}</small>`\n        });\n        break;\n      }\n\n      if (files.length < MAXIMUM_FILES_LIMIT) {\n        finalFileList.push(formattedFile);\n      } else {\n        Swal.fire({\n          icon: \"info\",\n          title: `The maximum file quantity to upload is ${MAXIMUM_FILES_LIMIT}`\n        });\n        break;\n      }\n    }\n\n    if (finalFileList.length > 0) {\n      setFiles([...files, ...finalFileList]);\n    }\n\n    event.target.value = event.target.defaultValue; // Reset input cached value\n  };\n  /* const handleRefIdChange = (event) => {\n   if (event.isTrusted) {\n  \t setRefId(event.target.value)\n   }\n  } \n  \t const handleSkuChange = (event) => {\n   if (event.isTrusted) {\n  \t setSku(event.target.value);\n   }\n  }v */\n\n\n  const handleFilesSubmit = async event => {\n    event.preventDefault();\n\n    if (event.isTrusted && skus !== \"\") {\n      const proceed = await Swal.fire({\n        title: \"The files will be uploaded to the S3 bucket. Proceed?\",\n        text: `The destination directory is /${idcliente}/${skus}`,\n        icon: \"question\",\n        confirmButtonText: \"Yes\",\n        cancelButtonText: \"No. Abort action\",\n        showCancelButton: true\n      });\n\n      if (!(proceed === null || proceed === void 0 ? void 0 : proceed.isConfirmed)) {\n        return;\n      }\n\n      setSubmitting(true);\n\n      try {\n        var _response$value;\n\n        const response = (await new FileProvider().submitFiles(files, idcliente, skus)).data;\n\n        if (response === null || response === void 0 ? void 0 : (_response$value = response.value) === null || _response$value === void 0 ? void 0 : _response$value.fileUpload) {\n          await Swal.fire({\n            title: `${files.length > 1 ? \"Files\" : \"File\"} uploaded successfully`,\n            icon: \"success\"\n          });\n          setFiles([]);\n        } else {\n          var _response$error$messa;\n\n          await Swal.fire({\n            title: (_response$error$messa = response.error.message) !== null && _response$error$messa !== void 0 ? _response$error$messa : \"Unexpected error\",\n            icon: \"error\"\n          });\n        }\n      } catch (reason) {\n        Swal.fire({\n          title: \"Unexpected error\",\n          text: \"Please try again later\",\n          icon: \"error\"\n        });\n      }\n\n      setSubmitting(false);\n      event.target.reset();\n    } else {\n      Swal.fire({\n        title: \"Opps!!\",\n        text: \"Please enter a valid SKU\",\n        icon: \"Warning\"\n      });\n    }\n  };\n\n  const removeFile = (event, index) => {\n    if (event.isTrusted) {\n      const currentFiles = files;\n      currentFiles.splice(index, 1);\n      setFiles([...currentFiles]);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleFilesSubmit,\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        padding: 3\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        gutterBottom: true,\n        children: [\"Upload Business and Legal Documents\", /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: \"You can later upload documents\",\n          children: /*#__PURE__*/_jsxDEV(Info, {\n            fontSize: \"small\",\n            color: \"info\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          id: \"file1\",\n          name: \"file1\",\n          type: \"file\",\n          onChange: getCurrentFiles,\n          variant: \"outlined\",\n          style: {\n            display: 'none'\n          },\n          multiple: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file1\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            startIcon: /*#__PURE__*/_jsxDEV(Attachment, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 24\n            }, this),\n            size: \"large\",\n            variant: \"outlined\",\n            component: \"span\",\n            color: \"secondary\",\n            children: \"Select File ...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 7\n      }, this), files.length > 0 ? /*#__PURE__*/_jsxDEV(FormControl, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          startIcon: /*#__PURE__*/_jsxDEV(Publish, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 24\n          }, this),\n          size: \"large\",\n          variant: \"outlined\",\n          color: \"primary\",\n          type: \"submit\",\n          children: \"Upload List\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this) : null, /*#__PURE__*/_jsxDEV(Typography, {\n        gutterBottom: true,\n        children: files.length > 0 ? `Files in queue (${files.length}):` : \"No files in queue yet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 7\n      }, this), files.length > 0 ? /*#__PURE__*/_jsxDEV(TableContainer, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          \"aria-label\": \"simple table\",\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"File Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"File Extension\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"File Size\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Actions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n            children: files.map((file, index) => {\n              return /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                  children: file.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 293,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: file.extension\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: getFormattedSize(file.size, 2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"outlined\",\n                    type: \"button\",\n                    onClick: event => removeFile(event, index),\n                    disabled: submitting,\n                    children: \"Remove\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 297,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 21\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 6\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SellerStoreFiles, \"kqY/I8fJjSpgjbq6dJarHt3dXpE=\");\n\n_c = SellerStoreFiles;\nexport default SellerStoreFiles;\n\nvar _c;\n\n$RefreshReg$(_c, \"SellerStoreFiles\");","map":{"version":3,"sources":["/Users/admin/Documents/gsatotal/newgsa/src/views/profile/components/SellerStoreFiles.jsx"],"names":["React","useState","useEffect","makeStyles","Paper","Button","Grid","Divider","FormLabel","FormControlLabel","TextField","Swal","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Typography","green","red","blue","Tooltip","FormControl","Save","Attachment","Info","Publish","FileProvider","checkFileMIMEType","checkFileSize","getFormattedSize","blobToBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","SellerStoreFiles","skus","idcliente","MAXIMUM_FILES_LIMIT","MAXIMUM_FILE_SIZE","ALLOWED_FORMATS","files","setFiles","submitting","setSubmitting","getCurrentFiles","event","rawFiles","target","fileList","Array","forEach","push","rawFilesArray","from","finalFileList","extensionSeparatorIndex","name","lastIndexOf","formattedName","substring","extension","substr","encodedData","formattedFile","toString","type","size","find","appendedFile","fire","icon","title","html","length","value","defaultValue","handleFilesSubmit","preventDefault","isTrusted","proceed","text","confirmButtonText","cancelButtonText","showCancelButton","isConfirmed","response","submitFiles","data","fileUpload","message","reason","reset","removeFile","index","currentFiles","splice","padding","display","map"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@mui/material/styles\";\nimport {\n  Paper,\n  Button,\n  Grid,\n  Divider,\n  FormLabel,\n  FormControlLabel,\n} from \"@mui/material\";\nimport TextField from \"@mui/material/TextField\";\nimport Swal from \"sweetalert2\";\nimport Table from \"@mui/material/Table\";\nimport TableBody from \"@mui/material/TableBody\";\nimport TableCell from \"@mui/material/TableCell\";\nimport TableContainer from \"@mui/material/TableContainer\";\nimport TableHead from \"@mui/material/TableHead\";\nimport TableRow from \"@mui/material/TableRow\";\nimport Typography from \"@mui/material/Typography\";\nimport { green, red, blue } from \"@mui/material/colors\";\nimport Tooltip from \"@mui/material/Tooltip\";\nimport FormControl from \"@mui/material/FormControl\";\nimport { Save, Attachment, Info, Publish } from \"@mui/icons-material\";\nimport FileProvider from \"../providers/file.provider\";\nimport {\n  checkFileMIMEType,\n  checkFileSize,\n  getFormattedSize,\n} from \"../helpers/files.helper\";\n\nconst blobToBase64 = async (file) =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = (error) => reject(error);\n  });\n\n/* const useStyles = makeStyles({\n  table: {\n    minWidth: 650,\n  },\n}); */\n\n/* const styles2 = makeStyles((theme) => ({\n  icons: {\n    fontSize: \"small\",\n    backgroundColor: red[500],\n    color: red[500],\n  },\n\n  formControl2: {\n    minWidth: 300,\n    padding: theme.spacing(1),\n  },\n\n  input: {\n    display: \"none\",\n  },\n\n  formControl1: {\n    minWidth: 100,\n    padding: theme.spacing(1),\n  },\n})); */\n\nconst SellerStoreFiles = ({ skus, idcliente }) => {\n  \n\n  const MAXIMUM_FILES_LIMIT = 5;\n  /**\n   * Size in MB\n   */\n  const MAXIMUM_FILE_SIZE = 2;\n  const ALLOWED_FORMATS = \".pdf, .doc, .docx, .odt, image/*\";\n\n  const [files, setFiles] = useState([]);\n  // const [refId, setRefId] = useState(idcliente);\n  // const [skur, setSku] = useState('');\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const getCurrentFiles = async (event) => {\n    const rawFiles = event.target.files;\n    const fileList = []; // WIll contain an array of type File[]\n    if (!rawFiles) {\n      return;\n    }\n    if (rawFiles instanceof Array) {\n      rawFiles.forEach((file) => fileList.push(file));\n    } else {\n      const rawFilesArray = Array.from(rawFiles);\n      rawFilesArray.forEach((file) => fileList.push(file));\n    }\n    const finalFileList = [];\n    for (const file of fileList) {\n      const extensionSeparatorIndex = file.name.lastIndexOf(\".\");\n      const formattedName = file.name.substring(0, extensionSeparatorIndex);\n      const extension = file.name.substr(extensionSeparatorIndex);\n      const encodedData = await blobToBase64(file);\n      const formattedFile = {\n        name: formattedName,\n        extension,\n        file: encodedData?.toString() ?? \"\",\n        type: \"append\",\n        size: file.size,\n      };\n      if (\n        files.find((appendedFile) => appendedFile.name === formattedFile.name)\n      ) {\n        Swal.fire({\n          icon: \"info\",\n          title: `The file ${\n            formattedFile.name + formattedFile.extension\n          } is already added`,\n        });\n        break;\n      }\n      if (!checkFileMIMEType(file.type, ALLOWED_FORMATS)) {\n        Swal.fire({\n          icon: \"warning\",\n          title:\n            \"Please select another file (Supported formats: images and PDF)\",\n          html: `<small class=\"text-muted\">The file ${file.name} is not supported</small>`,\n        });\n        break;\n      }\n      if (!checkFileSize(file.size, MAXIMUM_FILE_SIZE)) {\n        Swal.fire({\n          icon: \"warning\",\n          title: `The maximum file size is ${MAXIMUM_FILE_SIZE}MB`,\n          html: `<small class=\"text-muted\">The file ${\n            file.name\n          } have a size of ${getFormattedSize(file.size, 2)}</small>`,\n        });\n        break;\n      }\n      if (files.length < MAXIMUM_FILES_LIMIT) {\n        finalFileList.push(formattedFile);\n      } else {\n        Swal.fire({\n          icon: \"info\",\n          title: `The maximum file quantity to upload is ${MAXIMUM_FILES_LIMIT}`,\n        });\n        break;\n      }\n    }\n    if (finalFileList.length > 0) {\n      setFiles([...files, ...finalFileList]);\n    }\n    event.target.value = event.target.defaultValue; // Reset input cached value\n  };\n\n  /* const handleRefIdChange = (event) => {\n\t\t if (event.isTrusted) {\n\t\t\t setRefId(event.target.value)\n\t\t }\n\t } \n \n\t const handleSkuChange = (event) => {\n\t\t if (event.isTrusted) {\n\t\t\t setSku(event.target.value);\n\t\t }\n\t }v */\n\n  const handleFilesSubmit = async (event) => {\n    event.preventDefault();\n    if (event.isTrusted && skus !== \"\") {\n      const proceed = await Swal.fire({\n        title: \"The files will be uploaded to the S3 bucket. Proceed?\",\n        text: `The destination directory is /${idcliente}/${skus}`,\n        icon: \"question\",\n        confirmButtonText: \"Yes\",\n        cancelButtonText: \"No. Abort action\",\n        showCancelButton: true,\n      });\n      if (!proceed?.isConfirmed) {\n        return;\n      }\n      setSubmitting(true);\n      try {\n        const response = (\n          await new FileProvider().submitFiles(files, idcliente, skus)\n        ).data;\n        if (response?.value?.fileUpload) {\n          await Swal.fire({\n            title: `${\n              files.length > 1 ? \"Files\" : \"File\"\n            } uploaded successfully`,\n            icon: \"success\",\n          });\n          setFiles([]);\n        } else {\n          await Swal.fire({\n            title: response.error.message ?? \"Unexpected error\",\n            icon: \"error\",\n          });\n        }\n      } catch (reason) {\n        Swal.fire({\n          title: \"Unexpected error\",\n          text: \"Please try again later\",\n          icon: \"error\",\n        });\n      }\n      setSubmitting(false);\n      event.target.reset();\n    } else {\n      Swal.fire({\n        title: \"Opps!!\",\n        text: \"Please enter a valid SKU\",\n        icon: \"Warning\",\n      });\n    }\n  };\n\n  const removeFile = (event, index) => {\n    if (event.isTrusted) {\n      const currentFiles = files;\n      currentFiles.splice(index, 1);\n      setFiles([...currentFiles]);\n    }\n  };\n\n\n  return (\n    <form onSubmit={handleFilesSubmit}>\n     <Paper sx={{padding: 3}}>\n      <Typography variant=\"h6\" gutterBottom>\n        Upload Business and Legal Documents\n        <Tooltip title=\"You can later upload documents\">\n          <Info fontSize=\"small\" color=\"info\" />\n        </Tooltip>\n      </Typography>\n      <FormControl >\n        <TextField\n          id=\"file1\"\n          name=\"file1\"\n          type=\"file\"\n          onChange={getCurrentFiles}\n          variant=\"outlined\"\n          style = {{display:'none'}}\n          multiple\n        />\n        <label htmlFor=\"file1\">\n          <Button\n            startIcon={<Attachment />}\n            size=\"large\"\n            variant=\"outlined\"\n            component=\"span\"\n            color=\"secondary\"\n          >\n            Select File ...\n          </Button>\n        </label>\n      </FormControl>\n\n      {files.length > 0 ? (\n        <FormControl>\n          <Button\n            startIcon={<Publish />}\n            size=\"large\"\n            variant=\"outlined\"\n            color=\"primary\"\n            type=\"submit\"\n          >\n            Upload List\n          </Button>\n        </FormControl>\n      ) : null}\n\n      <Typography gutterBottom>\n        {files.length > 0\n          ? `Files in queue (${files.length}):`\n          : \"No files in queue yet\"}\n      </Typography>\n      {files.length > 0 ? (\n        <TableContainer>\n          <Table  aria-label=\"simple table\">\n            <TableHead>\n              <TableRow>\n                <TableCell>File Name</TableCell>\n                <TableCell>File Extension</TableCell>\n                <TableCell>File Size</TableCell>\n                <TableCell>Actions</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {files.map((file, index) => {\n                return (\n                  <TableRow key={index}>\n                    <TableCell>{file.name}</TableCell>\n                    <TableCell>{file.extension}</TableCell>\n                    <TableCell>{getFormattedSize(file.size, 2)}</TableCell>\n                    <TableCell>\n                      <Button\n                        variant=\"outlined\"\n                        type=\"button\"\n                        onClick={(event) => removeFile(event, index)}\n                        disabled={submitting}\n                      >\n                        Remove\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                );\n              })}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      ) : null}\n      </Paper>\n    </form>\n  );\n};\n\nexport default SellerStoreFiles;\n"]},"metadata":{},"sourceType":"module"}